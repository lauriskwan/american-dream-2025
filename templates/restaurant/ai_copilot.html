{% extends 'base.html' %}

{% block title %}AI Co-pilot - ReadyTable{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="mb-8">
        <h2 class="text-3xl font-bold text-gray-800 mb-2">AI Co-pilot</h2>
        <p class="text-gray-600">Get intelligent insights about your restaurant operations</p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Query Input -->
        <div class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">Ask Your AI Assistant</h3>
            
            <form method="post" class="space-y-4">
                {% csrf_token %}
                <div>
                    <label for="query" class="block text-sm font-medium text-gray-700 mb-2">Your Question</label>
                    <textarea id="query" name="query" rows="4" placeholder="Ask about popular dishes, busy times, revenue trends, or operational insights..." 
                              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 resize-none"></textarea>
                </div>
                <button type="submit" class="w-full bg-purple-600 text-white py-2 rounded-md hover:bg-purple-700 transition duration-200 flex items-center justify-center">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    Get Insights
                </button>
            </form>

            <!-- Sample Queries -->
            <div class="mt-6">
                <h4 class="text-sm font-medium text-gray-700 mb-3">Try these sample questions:</h4>
                <div class="space-y-2">
                    <button onclick="fillQuery('What were my most popular dishes this week?')" 
                            class="block w-full text-left text-sm text-blue-600 hover:text-blue-800 p-2 rounded hover:bg-blue-50 transition duration-200">
                        â€¢ What were my most popular dishes this week?
                    </button>
                    <button onclick="fillQuery('Forecast my busiest time tomorrow')" 
                            class="block w-full text-left text-sm text-blue-600 hover:text-blue-800 p-2 rounded hover:bg-blue-50 transition duration-200">
                        â€¢ Forecast my busiest time tomorrow
                    </button>
                    <button onclick="fillQuery('Show me revenue trends')" 
                            class="block w-full text-left text-sm text-blue-600 hover:text-blue-800 p-2 rounded hover:bg-blue-50 transition duration-200">
                        â€¢ Show me revenue trends
                    </button>
                </div>
            </div>
        </div>

        <!-- AI Response -->
        <div class="bg-white p-6 rounded-lg shadow-md">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">AI Insights</h3>
            
            {% if response %}
            <div class="bg-gray-50 p-4 rounded-lg">
                <div class="flex items-start">
                    <div class="w-8 h-8 bg-purple-600 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                        </svg>
                    </div>
                    <div class="flex-1">
                        <div class="text-sm text-gray-800 whitespace-pre-line">{{ response }}</div>
                    </div>
                </div>
            </div>
            {% else %}
            <div class="text-center text-gray-500 py-8">
                <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                </svg>
                <p>Ask a question to get AI-powered insights about your restaurant operations.</p>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Feature Info -->
    <div class="mt-8 bg-blue-50 p-6 rounded-lg">
        <h4 class="text-lg font-semibold text-blue-800 mb-2">ðŸš€ Coming Soon: Amazon Q Integration</h4>
        <p class="text-blue-700 text-sm mb-3">
            This AI Co-pilot currently shows simulated responses. In production, it will be powered by Amazon Q Developer Pro for real-time, data-driven insights.
        </p>
        <div class="text-sm text-blue-600">
            <strong>Planned Features:</strong>
            <ul class="list-disc list-inside mt-1 space-y-1">
                <li>Real-time sales and order analytics</li>
                <li>Predictive demand forecasting</li>
                <li>Menu optimization recommendations</li>
                <li>Staff scheduling insights</li>
                <li>Customer behavior analysis</li>
            </ul>
        </div>
    </div>
</div>

<script>
function fillQuery(query) {
    document.getElementById('query').value = query;
}

// Future Amazon Q API integration placeholder
/*
async function getAIInsights(query) {
    // This will be replaced with actual Amazon Q API calls
    
    try {
        const response = await fetch('/api/ai-insights/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken')
            },
            body: JSON.stringify({
                query: query,
                context: {
                    restaurant_id: 'your-restaurant-id',
                    time_range: '7d',
                    include_analytics: true
                }
            })
        });
        
        const data = await response.json();
        return data.insights;
        
    } catch (error) {
        console.error('Error getting AI insights:', error);
        return 'Sorry, I encountered an error processing your request.';
    }
}

// Amazon Q API integration example:
// 
// import boto3
// 
// def call_amazon_q_api(query, restaurant_data):
//     q_client = boto3.client('q-developer', region_name='us-east-1')
//     
//     response = q_client.generate_insights(
//         query=query,
//         context={
//             'restaurant_data': restaurant_data,
//             'data_sources': ['orders', 'menu_items', 'customer_feedback'],
//             'analysis_type': 'operational_insights'
//         }
//     )
//     
//     return response['insights']
*/
</script>
{% endblock %}
